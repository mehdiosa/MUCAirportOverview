//
//  TerminalsView.swift
//  AirportOverview
//
//  Created by Osama Mehdi on 26.07.23.
//

import SwiftUI

struct TerminalsView: View {
    var airportData: [[String: String]] = [[:]]
    var terminal: String = ""

    var body: some View {
        displayTerminalData(terminal)
    }

    @ViewBuilder
    func displayTerminalData(_ terminal: String) -> some View {
        let terminalData = getTerminalData(terminal)

        if terminalData.isEmpty {
            Text("No data available for Terminal " + terminal.dropFirst())
                .navigationTitle("Terminal " + terminal.dropFirst())
        }
        else {
            List {
                ForEach(terminalData, id: \.self) { flightData in
                    FlightView(airline: flightData["airline"]!,
                               departureCity: flightData["departureCity"]!,
                               flightNumber: flightData["number"]!,
                               status: flightData["status"]!,
                               plannedArrivalTime: flightData["plannedArrivalTime"]!,
                               expectedArrivalTime: flightData["expectedArrivalTime"]!,
                               terminal: flightData["area"]!)
                }
            }.navigationTitle("Terminal " + terminal.dropFirst())
        }
    }

    private func getTerminalData(_ terminal: String) -> [[String: String]] {
        var terminalData = [[String: String]]()

        for flightData in airportData {
            if !flightData.isEmpty {
                if flightData["area"]! == terminal {
                    terminalData.append(flightData)
                }
            }
        }
        return terminalData
    }
}

struct TerminalsView_Previews: PreviewProvider {
    static var previews: some View {
        TerminalsView(airportData: [["number": "LH 1665 (CRJ9)", "time_other": "14:10", "expectedArrivalTime": "14:50", "departureCity": "Sibiu (SBZ)", "airline": "Lufthansa", "area": "T2", "status": "beendet", "plannedArrivalTime": "14:55"], ["airline": "Lufthansa", "time_other": "11:10", "expectedArrivalTime": "14:55", "number": "LH 1783 (A20N)", "departureCity": "Porto (OPO)", "status": "beendet", "area": "T2", "plannedArrivalTime": "14:55"], ["number": "MS 787 (A20N)", "status": "beendet", "area": "T2", "departureCity": "Kairo (CAI)", "time_other": "12:05", "plannedArrivalTime": "14:55", "airline": "EGYPTAIR", "expectedArrivalTime": "15:00"], ["airline": "Lufthansa", "plannedArrivalTime": "15:00", "area": "T2", "expectedArrivalTime": "14:55", "time_other": "13:50", "departureCity": "Berlin (BER)", "number": "LH 1939 (A320)", "status": "Gepäck"], ["expectedArrivalTime": "15:25", "airline": "Lufthansa", "plannedArrivalTime": "15:00", "time_other": "11:50", "departureCity": "Tunis (TUN)", "status": "Gepäck", "area": "T2", "number": "LH 1745 (A321)"], ["status": "Gepäck", "expectedArrivalTime": "15:30", "area": "T2", "airline": "Lufthansa", "time_other": "13:15", "departureCity": "Neapel (NAP)", "number": "LH 1877 (A20N)", "plannedArrivalTime": "15:00"], ["number": "SN 2645 (A319)", "area": "T2", "airline": "Brussels Airlines", "status": "Gepäck", "time_other": "13:45", "plannedArrivalTime": "15:05", "expectedArrivalTime": "15:05", "departureCity": "Brüssel (BRU)"], ["status": "Gepäck", "plannedArrivalTime": "15:05", "time_other": "12:40", "airline": "Lufthansa", "departureCity": "Malta (MLA)", "number": "LH 1925 (A320)", "expectedArrivalTime": "15:20", "area": "T2"], ["time_other": "10:40", "plannedArrivalTime": "15:15", "departureCity": "Dschidda (JED)", "expectedArrivalTime": "15:10", "area": "T1D", "status": "beendet", "airline": "Saudia", "number": "SV 175 (A320)"], ["departureCity": "Marseille (MRS)", "time_other": "13:40", "plannedArrivalTime": "15:15", "area": "T2", "airline": "Lufthansa", "status": "Gepäck", "number": "LH 2263 (A319)", "expectedArrivalTime": "15:35"], ["plannedArrivalTime": "15:20", "status": "Gepäck", "time_other": "13:35", "departureCity": "Toulouse (TLS)", "area": "T2", "airline": "Lufthansa", "number": "LH 2219 (A320)", "expectedArrivalTime": "15:30"], ["time_other": "14:15", "area": "T1E", "airline": "Eurowings", "plannedArrivalTime": "15:25", "departureCity": "Düsseldorf (DUS)", "number": "EW 9088 (A319)", "expectedArrivalTime": "", "status": "annulliert"], ["expectedArrivalTime": "15:40", "airline": "Pegasus Airlines", "departureCity": "Istanbul (SAW)", "status": "Gepäck", "plannedArrivalTime": "15:30", "area": "T1C", "time_other": "13:45", "number": "PC 1021 (A20N)"], ["departureCity": "Barcelona (BCN)", "number": "LH 1813 (A20N)", "status": "Gepäck", "airline": "Lufthansa", "plannedArrivalTime": "15:35", "area": "T2", "time_other": "13:35", "expectedArrivalTime": "15:35"], ["departureCity": "Madeira / Funchal (FNC)", "plannedArrivalTime": "15:40", "number": "DE 1573 (A320)", "time_other": "10:40", "airline": "Condor", "area": "T1E", "status": "Gepäck", "expectedArrivalTime": "15:45"], ["area": "T2", "time_other": "14:05", "number": "EN 8309 (E195)", "status": "Gepäck", "plannedArrivalTime": "15:45", "expectedArrivalTime": "16:15", "airline": "AIR DOLOMITI", "departureCity": "Olbia (OLB)"], ["departureCity": "Reykjavik (KEF)", "expectedArrivalTime": "15:40", "area": "T1E", "airline": "Icelandair", "time_other": "10:10", "number": "FI 530 (B752)", "status": "Gepäck", "plannedArrivalTime": "15:55"], ["number": "BA 952 (A320)", "area": "T1C", "status": "Gepäck", "expectedArrivalTime": "16:20", "time_other": "13:05", "plannedArrivalTime": "16:00", "airline": "British Airways", "departureCity": "London (LHR)"], ["expectedArrivalTime": "16:10", "airline": "Lufthansa", "area": "T2", "departureCity": "Frankfurt (FRA)", "plannedArrivalTime": "16:10", "status": "Gepäck", "number": "LH 110 (B789)", "time_other": "15:15"], ["expectedArrivalTime": "16:20", "time_other": "13:30", "airline": "Lufthansa", "number": "LH 1823 (A320)", "status": "gelandet", "plannedArrivalTime": "16:20", "area": "T2", "departureCity": "Sevilla (SVQ)"], ["airline": "Lufthansa", "area": "T2", "time_other": "13:35", "departureCity": "London (LHR)", "status": "gestartet", "plannedArrivalTime": "16:25", "expectedArrivalTime": "17:20", "number": "LH 2475 (A20N)"], ["number": "LH 2061", "airline": "Lufthansa", "status": "im Anflug", "departureCity": "Hamburg (HAM)", "time_other": "15:15", "expectedArrivalTime": "16:55", "area": "T2", "plannedArrivalTime": "16:30"], ["airline": "Lufthansa", "number": "LH 2017 (A319)", "status": "gelandet", "expectedArrivalTime": "16:30", "time_other": "15:30", "plannedArrivalTime": "16:40", "departureCity": "Düsseldorf (DUS)", "area": "T2"], ["departureCity": "Bodrum (BJV)", "status": "gestartet", "time_other": "15:00", "number": "XQ 636 (B738)", "airline": "SunExpress", "plannedArrivalTime": "16:55", "area": "T1C", "expectedArrivalTime": "17:35"], ["status": "annulliert", "time_other": "15:35", "plannedArrivalTime": "17:00", "airline": "KLM", "departureCity": "Amsterdam (AMS)", "expectedArrivalTime": "", "area": "T1E", "number": "KL 1797 (E75L)"], ["departureCity": "Athen (ATH)", "area": "T2", "status": "im Anflug", "plannedArrivalTime": "17:00", "number": "LH 1753 (A21N)", "time_other": "15:25", "expectedArrivalTime": "17:00", "airline": "Lufthansa"], ["status": "gestartet", "plannedArrivalTime": "17:00", "departureCity": "Amsterdam (AMS)", "number": "LH 2305 (CRJ9)", "airline": "Lufthansa", "expectedArrivalTime": "17:10", "area": "T2", "time_other": "15:35"], ["area": "T2", "departureCity": "Berlin (BER)", "number": "LH 1943 (A321)", "airline": "Lufthansa", "status": "gestartet", "time_other": "15:50", "expectedArrivalTime": "17:30", "plannedArrivalTime": "17:00"], ["expectedArrivalTime": "16:55", "airline": "Luxair", "area": "T2", "plannedArrivalTime": "17:05", "departureCity": "Luxemburg (LUX)", "number": "LG 9735 (DH8D)", "status": "gelandet", "time_other": "15:55"], ["airline": "Lufthansa", "number": "LH 459 (A359)", "expectedArrivalTime": "20:10", "area": "T2", "time_other": "21:10", "departureCity": "San Francisco (SFO)", "status": "gestartet", "plannedArrivalTime": "17:05"], ["time_other": "16:15", "number": "LH 112 (A320)", "expectedArrivalTime": "", "departureCity": "Frankfurt (FRA)", "status": "verspätet", "plannedArrivalTime": "17:10", "area": "T2", "airline": "Lufthansa"], ["area": "T1E", "plannedArrivalTime": "17:10", "time_other": "15:40", "airline": "Air France", "expectedArrivalTime": "17:20", "departureCity": "Paris (CDG)", "status": "gestartet", "number": "AF 1822 (A320)"], ["departureCity": "Tokio (HND)", "number": "LH 715 (A359)", "status": "gestartet", "expectedArrivalTime": "19:05", "area": "T2", "airline": "Lufthansa", "time_other": "09:40", "plannedArrivalTime": "17:10"], ["departureCity": "Palma de Mallorca (PMI)", "number": "EW 1997 (A320)", "airline": "Eurowings", "area": "T1D", "time_other": "15:00", "status": "gestartet", "expectedArrivalTime": "17:20", "plannedArrivalTime": "17:15"], ["plannedArrivalTime": "17:20", "airline": "SunExpress", "time_other": "15:10", "area": "T1C", "status": "im Anflug", "departureCity": "Ankara (ESB)", "number": "XQ 714 (B738)", "expectedArrivalTime": "17:00"], ["number": "LH 2417 (A321)", "airline": "Lufthansa", "departureCity": "Stockholm (ARN)", "expectedArrivalTime": "17:30", "time_other": "15:10", "status": "gestartet", "area": "T2", "plannedArrivalTime": "17:20"], ["time_other": "15:50", "area": "T2", "number": "LH 1869 (A320)", "airline": "Lufthansa", "departureCity": "Rom (FCO)", "plannedArrivalTime": "17:25", "status": "gestartet", "expectedArrivalTime": "17:35"], ["number": "LH 2169 (CRJ9)", "time_other": "16:30", "departureCity": "Leipzig / Halle (LEJ)", "expectedArrivalTime": "", "plannedArrivalTime": "17:30", "airline": "Lufthansa", "area": "T2", "status": "verspätet"], ["airline": "AEGEAN", "departureCity": "Athen (ATH)", "number": "A3 806 (A20N)", "status": "gestartet", "expectedArrivalTime": "17:45", "time_other": "15:50", "area": "T2", "plannedArrivalTime": "17:30"], ["expectedArrivalTime": "", "time_other": "16:30", "status": "geplant", "area": "T2", "plannedArrivalTime": "17:35", "airline": "Lufthansa", "number": "LH 1981 (CRJ9)", "departureCity": "Köln / Bonn (CGN)"], ["airline": "Eurowings", "number": "EW 1995 (A320)", "time_other": "15:20", "status": "gestartet", "plannedArrivalTime": "17:35", "departureCity": "Palma de Mallorca (PMI)", "expectedArrivalTime": "17:35", "area": "T1D"], ["plannedArrivalTime": "17:35", "status": "gestartet", "area": "T1E", "time_other": "15:00", "departureCity": "Madrid (MAD)", "number": "UX 1517 (B738)", "expectedArrivalTime": "17:35", "airline": "Air Europa"], ["airline": "Lufthansa", "plannedArrivalTime": "17:35", "number": "LH 1815 (A20N)", "departureCity": "Barcelona (BCN)", "area": "T2", "status": "gestartet", "time_other": "15:35", "expectedArrivalTime": "17:45"], ["number": "SK 2657 (CRJ9)", "area": "T2", "airline": "SAS", "departureCity": "Kopenhagen (CPH)", "status": "verspätet", "time_other": "16:05", "plannedArrivalTime": "17:40", "expectedArrivalTime": ""], ["departureCity": "Palma de Mallorca (PMI)", "status": "gestartet", "area": "T2", "number": "LH 1797 (A321)", "airline": "Lufthansa", "plannedArrivalTime": "17:40", "time_other": "15:30", "expectedArrivalTime": "17:40"], ["time_other": "16:30", "departureCity": "Brüssel (BRU)", "airline": "Lufthansa", "number": "LH 2289 (A320)", "plannedArrivalTime": "17:45", "status": "geplant", "area": "T2", "expectedArrivalTime": ""], ["area": "T2", "expectedArrivalTime": "", "status": "verspätet", "departureCity": "Prag (PRG)", "time_other": "16:55", "plannedArrivalTime": "17:50", "number": "LH 1693 (A319)", "airline": "Lufthansa"], ["status": "geplant", "time_other": "16:55", "number": "LH 2371 (CRJ9)", "plannedArrivalTime": "17:50", "expectedArrivalTime": "", "airline": "Lufthansa", "departureCity": "Zürich (ZRH)", "area": "T2"], ["plannedArrivalTime": "17:50", "number": "LH 719 (A359)", "airline": "Lufthansa", "area": "T2", "departureCity": "Seoul (ICN)", "expectedArrivalTime": "17:30", "status": "gestartet", "time_other": "11:40"], ["number": "AY 1405 (A321)", "time_other": "16:15", "plannedArrivalTime": "17:50", "status": "gestartet", "airline": "Finnair", "departureCity": "Helsinki (HEL)", "expectedArrivalTime": "17:50", "area": "T1E"], ["plannedArrivalTime": "17:50", "number": "MBU 6601 (A320)", "time_other": "16:00", "status": "gestartet", "expectedArrivalTime": "18:10", "airline": "Marabu", "departureCity": "Heraklion (HER)", "area": "T1A"]], terminal: "T2")
    }
}
